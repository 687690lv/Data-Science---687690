setwd("H:/My Drive/Studies/Master/Courses/DTS/4. RStudio/Data")
browser <-read.csv("web-browsers.csv")

#1. Quantification: frequentist method and the Bootstrap

##Mean

###Frequentist method
mean_f_spend<-mean(browser$spend) #this would be the center of the normal distribution
mean_f_spend

n<-nrow(browser)
var_f_spend<-var(browser$spend)/n #this would determine the amplitude of the normal distribution
sd_f_spend<-sqrt(var_f_spend)
sd_f_spend

x<-seq(1700, 2200, length=100)
y<-dnorm(x, mean=mean_f_spend, sd=sd_f_spend)
plot(x,y)
lines(x,y, col="red")


###Bootstrap

nr<-5000 #number of resamples
v<-c() #a vector of "n" rows containing mean of resamples
sr<-nrow(browser) #should be always equal to the size of the original sample?

for (i in 1:nr){
  resample<-sample.int(sr, replace=TRUE)
  v=c(v,mean(browser$spend[resample]))
  }

sd(v) #quantification of uncertainty under the Bootstrap

h_v<-hist(v)
x<-seq(min(v), max(v), lenght=100)
y<-dnorm(x, mean=mean_f_spend, sd=sd_f_spend)
y<-y*diff(h_v$mids[1:2])*n #Its the density multiplied by the number of observations, multiplied by ? to get the frequency
lines(x,y,col="green", lwd=2)
